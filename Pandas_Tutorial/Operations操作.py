import numpy as np
import pandas as pd
from Selection选择 import df

dates=pd.date_range('20180101',periods=6)

'''统计'''
print(df.mean())
# A   -0.029139
# B   -0.241363
# C    0.582015
# D    5.000000
# F    3.000000
# dtype: float64
'''另一个轴'''
print(df.mean(1))
# 2018-01-01    1.296622
# 2018-01-02    0.850654
# 2018-01-03    1.551481
# 2018-01-04    2.043344
# 2018-01-05    1.632430
# 2018-01-06    2.236133
# Freq: D, dtype: float64
'''自动沿指定维度进行广播'''
s=pd.Series([1,3,5,np.nan,6,8],index=dates).shift(2)
# 向下移动了2个位置
print(s)
# 2018-01-01    NaN
# 2018-01-02    NaN
# 2018-01-03    1.0
# 2018-01-04    3.0
# 2018-01-05    5.0
# 2018-01-06    NaN
# Freq: D, dtype: float64
print(df)
#                    A         B         C  D    F
# 2018-01-01  0.000000  0.000000  1.623370  5  NaN
# 2018-01-02 -1.114548  0.878259  0.132677  5  1.0
# 2018-01-03 -0.063794  0.941833 -0.755816  5  2.0
# 2018-01-04  0.232953 -3.303454 -2.029727  5  3.0
# 2018-01-05 -0.849328  0.087983 -0.562929  5  4.0
# 2018-01-06  0.096758 -0.051371 -0.375536  5  5.0
print(df.sub(s,axis='index'))#减去s
#                    A         B         C    D    F
# 2018-01-01       NaN       NaN       NaN  NaN  NaN
# 2018-01-02       NaN       NaN       NaN  NaN  NaN
# 2018-01-03 -1.063794 -0.058167 -1.755816  4.0  1.0
# 2018-01-04 -2.767047 -6.303454 -5.029727  2.0  0.0
# 2018-01-05 -5.849328 -4.912017 -5.562929  0.0 -1.0
# 2018-01-06       NaN       NaN       NaN  NaN  NaN
'''----------------apply(func)-----------------------'''
'''把函数应用于数据'''
print(df.apply(np.cumsum))#累计和
#                    A         B         C   D     F
# 2018-01-01  0.000000  0.000000 -2.124547   5   NaN
# 2018-01-02 -0.131732 -0.032565 -2.632982  10   1.0
# 2018-01-03  0.923379  0.567954 -1.791400  15   3.0
# 2018-01-04  0.939310 -0.303933 -1.583251  20   6.0
# 2018-01-05  2.199275 -0.184479 -2.114410  25  10.0
# 2018-01-06  1.845063 -0.897481 -2.795216  30  15.0
print(df.apply(lambda x:x.max()-x.min()))
# A    1.880717
# B    0.849795
# C    4.822664
# D    0.000000
# F    4.000000
# dtype: float64
'''-----------------直方图--------------------------------'''
s=pd.Series(np.random.randint(0,7,size=10))
print(s)
# 0    2
# 1    4
# 2    6
# 3    4
# 4    0
# 5    5
# 6    0
# 7    3
# 8    5
# 9    5
# dtype: int32
print(s.value_counts())#值 统计
# 4    2
# 1    2
# 0    2
# 6    1
# 5    1
# 3    1
# 2    1
# dtype: int64
'''--------------------------字符串方法(DataFrame.str)-------------------'''
s=pd.Series(['A', 'B', 'C', 'Aaba', 'Baca', np.nan, 'CABA', 'dog', 'cat'])
s.str.lower()
# 0       a
# 1       b
# 2       c
# 3    aaba
# 4    baca
# 5     NaN
# 6    caba
# 7     dog
# 8     cat
# dtype: object